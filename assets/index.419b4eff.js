import{s as S,d as at,T as F,i as L,a as J,h as ct,r as nt,c as ht,H as lt,b as q,e as ft}from"./index.7e0cd7a3.js";import{f as Yt}from"./index.7e0cd7a3.js";function mt(e){let u;for(;u=e.sourceEvent;)e=u;return e}function O(e,u){if(e=mt(e),u===void 0&&(u=e.currentTarget),u){var h=u.ownerSVGElement||u;if(h.createSVGPoint){var f=h.createSVGPoint();return f.x=e.clientX,f.y=e.clientY,f=f.matrixTransform(u.getScreenCTM().inverse()),[f.x,f.y]}if(u.getBoundingClientRect){var g=u.getBoundingClientRect();return[e.clientX-g.left-u.clientLeft,e.clientY-g.top-u.clientTop]}}return[e.pageX,e.pageY]}const N={capture:!0,passive:!1};function tt(e){e.preventDefault(),e.stopImmediatePropagation()}function gt(e){var u=e.document.documentElement,h=S(e).on("dragstart.drag",tt,N);"onselectstart"in u?h.on("selectstart.drag",tt,N):(u.__noselect=u.style.MozUserSelect,u.style.MozUserSelect="none")}function pt(e,u){var h=e.document.documentElement,f=S(e).on("dragstart.drag",null);u&&(f.on("click.drag",tt,N),setTimeout(function(){f.on("click.drag",null)},0)),"onselectstart"in h?f.on("selectstart.drag",null):(h.style.MozUserSelect=h.__noselect,delete h.__noselect)}var dt=1e-12;function ot(e){return((e=Math.exp(e))+1/e)/2}function yt(e){return((e=Math.exp(e))-1/e)/2}function vt(e){return((e=Math.exp(2*e))-1)/(e+1)}var zt=function e(u,h,f){function g(p,l){var z=p[0],b=p[1],v=p[2],C=l[0],R=l[1],_=l[2],j=C-z,B=R-b,k=j*j+B*B,I,s;if(k<dt)s=Math.log(_/v)/u,I=function($){return[z+$*j,b+$*B,v*Math.exp(u*$*s)]};else{var V=Math.sqrt(k),E=(_*_-v*v+f*k)/(2*v*h*V),H=(_*_-v*v-f*k)/(2*_*h*V),Y=Math.log(Math.sqrt(E*E+1)-E),w=Math.log(Math.sqrt(H*H+1)-H);s=(w-Y)/u,I=function($){var K=$*s,U=ot(Y),Z=v/(h*V)*(U*vt(u*K+Y)-yt(Y));return[z+Z*j,b+Z*B,v*U/ot(u*K+Y)]}}return I.duration=s*1e3*u/Math.SQRT2,I}return g.rho=function(p){var l=Math.max(.001,+p),z=l*l,b=z*z;return e(l,z,b)},g}(Math.SQRT2,2,4),Q=e=>()=>e;function _t(e,{sourceEvent:u,target:h,transform:f,dispatch:g}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:u,enumerable:!0,configurable:!0},target:{value:h,enumerable:!0,configurable:!0},transform:{value:f,enumerable:!0,configurable:!0},_:{value:g}})}function et(e){e.stopImmediatePropagation()}function W(e){e.preventDefault(),e.stopImmediatePropagation()}function wt(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Mt(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function it(){return this.__zoom||L}function xt(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Tt(){return navigator.maxTouchPoints||"ontouchstart"in this}function bt(e,u,h){var f=e.invertX(u[0][0])-h[0][0],g=e.invertX(u[1][0])-h[1][0],p=e.invertY(u[0][1])-h[0][1],l=e.invertY(u[1][1])-h[1][1];return e.translate(g>f?(f+g)/2:Math.min(0,f)||Math.max(0,g),l>p?(p+l)/2:Math.min(0,p)||Math.max(0,l))}function Et(){var e=wt,u=Mt,h=bt,f=xt,g=Tt,p=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],z=250,b=zt,v=at("start","zoom","end"),C,R,_,j=500,B=150,k=0,I=10;function s(t){t.property("__zoom",it).on("wheel.zoom",K,{passive:!1}).on("mousedown.zoom",U).on("dblclick.zoom",Z).filter(g).on("touchstart.zoom",ut).on("touchmove.zoom",st).on("touchend.zoom touchcancel.zoom",rt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}s.transform=function(t,o,n,i){var r=t.selection?t.selection():t;r.property("__zoom",it),t!==r?Y(t,o,n,i):r.interrupt().each(function(){w(this,arguments).event(i).start().zoom(null,typeof o=="function"?o.apply(this,arguments):o).end()})},s.scaleBy=function(t,o,n,i){s.scaleTo(t,function(){var r=this.__zoom.k,a=typeof o=="function"?o.apply(this,arguments):o;return r*a},n,i)},s.scaleTo=function(t,o,n,i){s.transform(t,function(){var r=u.apply(this,arguments),a=this.__zoom,c=n==null?H(r):typeof n=="function"?n.apply(this,arguments):n,m=a.invert(c),d=typeof o=="function"?o.apply(this,arguments):o;return h(E(V(a,d),c,m),r,l)},n,i)},s.translateBy=function(t,o,n,i){s.transform(t,function(){return h(this.__zoom.translate(typeof o=="function"?o.apply(this,arguments):o,typeof n=="function"?n.apply(this,arguments):n),u.apply(this,arguments),l)},null,i)},s.translateTo=function(t,o,n,i,r){s.transform(t,function(){var a=u.apply(this,arguments),c=this.__zoom,m=i==null?H(a):typeof i=="function"?i.apply(this,arguments):i;return h(L.translate(m[0],m[1]).scale(c.k).translate(typeof o=="function"?-o.apply(this,arguments):-o,typeof n=="function"?-n.apply(this,arguments):-n),a,l)},i,r)};function V(t,o){return o=Math.max(p[0],Math.min(p[1],o)),o===t.k?t:new F(o,t.x,t.y)}function E(t,o,n){var i=o[0]-n[0]*t.k,r=o[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new F(t.k,i,r)}function H(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function Y(t,o,n,i){t.on("start.zoom",function(){w(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).event(i).end()}).tween("zoom",function(){var r=this,a=arguments,c=w(r,a).event(i),m=u.apply(r,a),d=n==null?H(m):typeof n=="function"?n.apply(r,a):n,T=Math.max(m[1][0]-m[0][0],m[1][1]-m[0][1]),y=r.__zoom,M=typeof o=="function"?o.apply(r,a):o,D=b(y.invert(d).concat(T/y.k),M.invert(d).concat(T/M.k));return function(x){if(x===1)x=M;else{var P=D(x),A=T/P[2];x=new F(A,d[0]-P[0]*A,d[1]-P[1]*A)}c.zoom(null,x)}})}function w(t,o,n){return!n&&t.__zooming||new $(t,o)}function $(t,o){this.that=t,this.args=o,this.active=0,this.sourceEvent=null,this.extent=u.apply(t,o),this.taps=0}$.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active==1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,o){return this.mouse&&t!=="mouse"&&(this.mouse[1]=o.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=o.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=o.invert(this.touch1[0])),this.that.__zoom=o,this.emit("zoom"),this},end:function(){return--this.active==0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var o=S(this.that).datum();v.call(t,this.that,new _t(t,{sourceEvent:this.sourceEvent,target:s,type:t,transform:this.that.__zoom,dispatch:v}),o)}};function K(t,...o){if(!e.apply(this,arguments))return;var n=w(this,o).event(t),i=this.__zoom,r=Math.max(p[0],Math.min(p[1],i.k*Math.pow(2,f.apply(this,arguments)))),a=O(t);if(n.wheel)(n.mouse[0][0]!==a[0]||n.mouse[0][1]!==a[1])&&(n.mouse[1]=i.invert(n.mouse[0]=a)),clearTimeout(n.wheel);else{if(i.k===r)return;n.mouse=[a,i.invert(a)],J(this),n.start()}W(t),n.wheel=setTimeout(c,B),n.zoom("mouse",h(E(V(i,r),n.mouse[0],n.mouse[1]),n.extent,l));function c(){n.wheel=null,n.end()}}function U(t,...o){if(_||!e.apply(this,arguments))return;var n=t.currentTarget,i=w(this,o,!0).event(t),r=S(t.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",T,!0),a=O(t,n),c=t.clientX,m=t.clientY;gt(t.view),et(t),i.mouse=[a,this.__zoom.invert(a)],J(this),i.start();function d(y){if(W(y),!i.moved){var M=y.clientX-c,D=y.clientY-m;i.moved=M*M+D*D>k}i.event(y).zoom("mouse",h(E(i.that.__zoom,i.mouse[0]=O(y,n),i.mouse[1]),i.extent,l))}function T(y){r.on("mousemove.zoom mouseup.zoom",null),pt(y.view,i.moved),W(y),i.event(y).end()}}function Z(t,...o){if(!!e.apply(this,arguments)){var n=this.__zoom,i=O(t.changedTouches?t.changedTouches[0]:t,this),r=n.invert(i),a=n.k*(t.shiftKey?.5:2),c=h(E(V(n,a),i,r),u.apply(this,o),l);W(t),z>0?S(this).transition().duration(z).call(Y,c,i,t):S(this).call(s.transform,c,i,t)}}function ut(t,...o){if(!!e.apply(this,arguments)){var n=t.touches,i=n.length,r=w(this,o,t.changedTouches.length===i).event(t),a,c,m,d;for(et(t),c=0;c<i;++c)m=n[c],d=O(m,this),d=[d,this.__zoom.invert(d),m.identifier],r.touch0?!r.touch1&&r.touch0[2]!==d[2]&&(r.touch1=d,r.taps=0):(r.touch0=d,a=!0,r.taps=1+!!C);C&&(C=clearTimeout(C)),a&&(r.taps<2&&(R=d[0],C=setTimeout(function(){C=null},j)),J(this),r.start())}}function st(t,...o){if(!!this.__zooming){var n=w(this,o).event(t),i=t.changedTouches,r=i.length,a,c,m,d;for(W(t),a=0;a<r;++a)c=i[a],m=O(c,this),n.touch0&&n.touch0[2]===c.identifier?n.touch0[0]=m:n.touch1&&n.touch1[2]===c.identifier&&(n.touch1[0]=m);if(c=n.that.__zoom,n.touch1){var T=n.touch0[0],y=n.touch0[1],M=n.touch1[0],D=n.touch1[1],x=(x=M[0]-T[0])*x+(x=M[1]-T[1])*x,P=(P=D[0]-y[0])*P+(P=D[1]-y[1])*P;c=V(c,Math.sqrt(x/P)),m=[(T[0]+M[0])/2,(T[1]+M[1])/2],d=[(y[0]+D[0])/2,(y[1]+D[1])/2]}else if(n.touch0)m=n.touch0[0],d=n.touch0[1];else return;n.zoom("touch",h(E(c,m,d),n.extent,l))}}function rt(t,...o){if(!!this.__zooming){var n=w(this,o).event(t),i=t.changedTouches,r=i.length,a,c;for(et(t),_&&clearTimeout(_),_=setTimeout(function(){_=null},j),a=0;a<r;++a)c=i[a],n.touch0&&n.touch0[2]===c.identifier?delete n.touch0:n.touch1&&n.touch1[2]===c.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(c=O(c,this),Math.hypot(R[0]-c[0],R[1]-c[1])<I)){var m=S(this).on("dblclick.zoom");m&&m.apply(this,arguments)}}}return s.wheelDelta=function(t){return arguments.length?(f=typeof t=="function"?t:Q(+t),s):f},s.filter=function(t){return arguments.length?(e=typeof t=="function"?t:Q(!!t),s):e},s.touchable=function(t){return arguments.length?(g=typeof t=="function"?t:Q(!!t),s):g},s.extent=function(t){return arguments.length?(u=typeof t=="function"?t:Q([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),s):u},s.scaleExtent=function(t){return arguments.length?(p[0]=+t[0],p[1]=+t[1],s):[p[0],p[1]]},s.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],s):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},s.constrain=function(t){return arguments.length?(h=t,s):h},s.duration=function(t){return arguments.length?(z=+t,s):z},s.interpolate=function(t){return arguments.length?(b=t,s):b},s.on=function(){var t=v.on.apply(v,arguments);return t===v?s:t},s.clickDistance=function(t){return arguments.length?(k=(t=+t)*t,s):Math.sqrt(k)},s.tapDistance=function(t){return arguments.length?(I=+t,s):I},s}var Dt=Object.defineProperty,Pt=Object.getOwnPropertyDescriptor,G=(e,u,h,f)=>{for(var g=f>1?void 0:f?Pt(u,h):u,p=e.length-1,l;p>=0;p--)(l=e[p])&&(g=(f?l(u,h,g):l(g))||g);return f&&g&&Dt(u,h,g),g};const St=ct`
<svg ${nt("_svg")} width="${e=>e.width}" height="${e=>e.height}" viewbox="[0, 0, ${e=>e._svg.clientWidth}, ${e=>e._svg.clientHeight}]">
    <foreignObject ${nt("_content")} x="0" y="0" width="100%" height="100%">
        <slot>
        </slot>
    </foreignObject>
</svg>
`,Ct=ht`
svg {
}
`;let X=class extends lt{constructor(){super(...arguments);this.scaleMin=.1,this.scaleMax=2,this.x=0,this.y=0,this.scale=1,this._zoom=Et().on("zoom",({transform:e})=>{this.x=e.x,this.y=e.y,this.scale=e.k})}enter(){super.enter(),this.content=S(this._content),S(this._svg).call(this._zoom)}update(e){super.update(e),this._zoom.extent([[0,0],[this._svg.clientWidth,this._svg.clientHeight]]).scaleExtent([this.scaleMin,this.scaleMax]),(e.x!==void 0||e.y!==void 0||e.scale!==void 0)&&(this.content.attr("transform",L.translate(this.x,this.y).scale(this.scale)),this.$emit("zoom"))}};G([q],X.prototype,"scaleMin",2);G([q],X.prototype,"scaleMax",2);G([q],X.prototype,"x",2);G([q],X.prototype,"y",2);G([q],X.prototype,"scale",2);X=G([ft({name:"hpcc-zoom",template:St,styles:Ct})],X);export{Yt as HPCCSankeyElement,X as HPCCZoomElement};
